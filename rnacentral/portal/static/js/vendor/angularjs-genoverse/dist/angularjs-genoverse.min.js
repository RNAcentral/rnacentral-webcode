!function(){function e(){return function(e){return"Canis familiaris"==e&&(e="Canis lupus familiaris"),e.replace(/ /g,"_").toLowerCase()}}function n(){return function(e){"canis_lupus_familiaris"==e&&(e="canis_familiaris");var n=e.replace(/_/g," ");return n=n.charAt(0).toUpperCase()+n.slice(1)}}function r(){return function(e){return e.toString().match(/^\d+$|^[XYM]$/)?"chr"+e.toString():e.toString()}}function o(e){return{restrict:"E",scope:!1,template:"<div class='wrap genoverse-wrap' style='overflow-x:auto;'>    <p class='text-muted'>        <span id='genomic-location' class='margin-right-5px'></span>        View in <a href='http://{{domain}}/{{genome.species | urlencodeSpecies}}/Location/View?r={{chromosome}}:{{start}}-{{end}}' id='ensembl-link' target='_blank'>Ensembl</a>        <span ng-show='genome.assembly_ucsc' class='ucsc-link'>|            <a href='http://genome.ucsc.edu/cgi-bin/hgTracks?db={{genome.assembly_ucsc}}&position={{chromosome | chrToUCSC}}%3A{{start}}-{{end}}' target='_blank'>UCSC</a>        </span>    </p><div id='genoverse'></div></div>",link:function(n,r,o){function s(){var e={container:r.find("#genoverse"),chr:n.chromosome,start:n.start,end:n.end,species:n.genome.species,showUrlCoords:!1,plugins:["controlPanel","resizer","fileDrop"],tracks:[Genoverse.Track.Scalebar,Genoverse.Track.extend({name:"Sequence",model:t("ensemblSequence"),view:Genoverse.Track.View.Sequence,controller:Genoverse.Track.Controller.Sequence,resizable:"auto",1e5:!1}),Genoverse.Track.extend({name:"Genes",info:"Ensembl API genes",labels:!0,model:t("ensemblGene"),view:Genoverse.Track.View.Gene.Ensembl,controller:Genoverse.Track.Controller.Ensembl}),Genoverse.Track.extend({name:"Transcripts",info:"Ensembl API transcripts",labels:!0,model:t("ensemblTranscript"),view:Genoverse.Track.View.Transcript.Ensembl,controller:Genoverse.Track.Controller.Ensembl}),Genoverse.Track.extend({name:"RNAcentral",id:"RNAcentral",info:"Unique RNAcentral Sequences",labels:!0,model:t("rnacentral"),view:Genoverse.Track.View.Transcript.Ensembl,controller:Genoverse.Track.Controller.Ensembl})]};l(n.genome.species)?(e.plugins.push("karyotype"),e.genome="grch38"):e.chromosomeSize=Math.pow(10,20),n.browser=new Genoverse(e),n.domain=g(n.genome),l(n.genome.species)||r.find(".gv_wrapper").prepend("<div class='genoverse_karyotype_placeholder'>    <p>Karyotype display is not available</p></div>"),p()}function a(){var e=n.$watch("browser.species",function(e,r){n.genome=d(e),n.domain=g(n.genome)}),r=n.$watch("browser.chr",function(e,r){n.chromosome=e}),o=n.$watch("browser.start",function(e,r){n.start=e}),s=n.$watch("browser.end",function(e,r){n.end=e});return[e,r,o,s]}function i(e){n.$watch("start",function(e,r){n.browser.setRange(e,n.end,!0)}),n.$watch("end",function(e,r){n.browser.setRange(n.start,e,!0)}),n.$watch("genome",function(o,i){e.forEach(function(e){e()}),r.find("#genoverse").html(""),delete n.browser,o!==i&&(n.chromosome=o.example_location.chromosome,n.start=o.example_location.start,n.end=o.example_location.end),s(),m(),a()}),n.$watch("chromosome",function(o,i){e.forEach(function(e){e()}),r.find("#genoverse").html(""),delete n.browser,s(),m(),a()})}function t(r){var o,s,a=c(n.genome.species);return"ensemblGene"===r?(s="//__ENDPOINT__/overlap/region/__SPECIES__/__CHR__:__START__-__END__?feature=gene;content-type=application/json".replace("__ENDPOINT__",a).replace("__SPECIES__",e("urlencodeSpecies")(n.genome.species)),o=Genoverse.Track.Model.Gene.Ensembl.extend({url:s})):"ensemblTranscript"===r?(s="//__ENDPOINT__/overlap/region/__SPECIES__/__CHR__:__START__-__END__?feature=transcript;feature=exon;feature=cds;content-type=application/json".replace("__ENDPOINT__",a).replace("__SPECIES__",e("urlencodeSpecies")(n.genome.species)),o=Genoverse.Track.Model.Transcript.Ensembl.extend({url:s})):"ensemblSequence"===r?(s="//__ENDPOINT__/sequence/region/__SPECIES__/__CHR__:__START__-__END__?content-type=text/plain".replace("__ENDPOINT__",a).replace("__SPECIES__",e("urlencodeSpecies")(n.genome.species)),o=Genoverse.Track.Model.Sequence.Ensembl.extend({url:s})):"rnacentral"===r&&(window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.host+"/"),s=window.location.origin+"/api/v1/overlap/region/__SPECIES__/__CHR__:__START__-__END__".replace("__SPECIES__",e("urlencodeSpecies")(n.genome.species)),o=Genoverse.Track.Model.Gene.Ensembl.extend({url:s,parseData:function(e){for(var n=0;n<e.length;n++){var r=e[n];"transcript"!==r.feature_type||this.featuresById[r.ID]?"exon"===r.feature_type&&this.featuresById[r.Parent]&&(r.id=r.ID,this.featuresById[r.Parent].exons[r.id]||(this.featuresById[r.Parent].exons.push(r),this.featuresById[r.Parent].exons[r.id]=r)):(r.id=r.ID,r.label=r.external_name,r.exons=[],r.cds=[],this.insertFeature(r))}}})),o}function c(n){var r=["ailuropoda_melanoleuca","anas_platyrhynchos","anolis_carolinensis","astyanax_mexicanus","bos_taurus","callithrix_jacchus","canis_lupus_familiaris","cavia_porcellus","ceratotherium_simum_simum","chlorocebus_sabaeus","choloepus_hoffmanni","chrysemys_picta_bellii","ciona_intestinalis","ciona_savignyi","cricetulus_griseus","danio_rerio","dasypus_novemcinctus","dipodomys_ordii","drosophila_melanogaster","echinops_telfairi","equus_caballus","erinaceus_europaeus","felis_catus","ficedula_albicollis","gadus_morhua","gallus_gallus","gasterosteus_aculeatus","gorilla_gorilla_gorilla","heterocephalus_glaber","homo_sapiens","ictidomys_tridecemlineatus","latimeria_chalumnae","lepisosteus_oculatus","loxodonta_africana","macaca_fascicularis","macaca_mulatta","macropus_eugenii","meleagris_gallopavo","melopsittacus_undulatus","microcebus_murinus","microtus_ochrogaster","monodelphis_domestica","mus_musculus","mustela_putorius_furo","myotis_lucifugus","nomascus_leucogenys","ochotona_princeps","oreochromis_niloticus","ornithorhynchus_anatinus","orycteropus_afer_afer","oryctolagus_cuniculus","oryzias_latipes","otolemur_garnettii","ovis_aries","pan_troglodytes","papio_anubis","papio_hamadryas","pelodiscus_sinensis","petromyzon_marinus","poecilia_formosa","pongo_abelii","procavia_capensis","pteropus_vampyrus","rattus_norvegicus","saimiri_boliviensis","sarcophilus_harrisii","sorex_araneus","sus_scrofa","sus_scrofa_map","taeniopygia_guttata","takifugu_rubripes","tarsius_syrichta","tetraodon_nigroviridis","tupaia_belangeri","tursiops_truncatus","vicugna_pacos","xenopus_tropicalis","xiphophorus_maculatus"],o=e("urlencodeSpecies")(n);return r.indexOf(o)>-1?"rest.ensembl.org":"rest.ensemblgenomes.org"}function l(e){return u(e)&&_()}function u(e){var n=["Homo sapiens"];return n.indexOf(e)!==-1}function _(){var e=[];for(var r in grch38)e.push(r);return e.indexOf(n.chromosome.toString())}function m(){n.browser.on({afterSetRange:function(){n.$$phase||n.$apply(),setTimeout(function(){r.find(".genoverse-wrap .resizer").click()},1e3)}})}function p(){var e=r.find(".container").width();r.find(".wrap").width(e),r.find("#genoverse").width(e)}function d(e){e=e.replace(/_/g," ");for(var n=0;n<genomes.length;n++){if(e.toLowerCase()==genomes[n].species.toLowerCase())return genomes[n];var r=[];if(genomes[n].synonyms.forEach(function(e){r.push(e.toLowerCase())}),r.indexOf(e.toLowerCase())>-1)return genomes[n]}return null}function g(e){var n;return"Ensembl"==e.division?n="ensembl.org":"Ensembl Plants"==e.division?n="plants.ensembl.org":"Ensembl Metazoa"==e.division?n="metazoa.ensembl.org":"Ensembl Bacteria"==e.division?n="bacteria.ensembl.org":"Ensembl Fungi"==e.division?n="fungi.ensembl.org":"Ensembl Protists"==e.division&&(n="protists.ensembl.org"),n}s();var f=a();i(f),m(),window.onresize(p)}}}angular.module("Genoverse",[]).filter("urlencodeSpecies",e).filter("urldecodeSpecies",n).filter("chrToUCSC",r).directive("genoverse",o)}();
//# sourceMappingURL=dist/angularjs-genoverse.min.js.map